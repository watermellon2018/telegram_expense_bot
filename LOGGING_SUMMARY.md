# üìä –°–≤–æ–¥–∫–∞ –ø–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—é

## ‚úÖ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. Middleware –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- **–§–∞–π–ª:** `utils/logging_middleware.py`
- **–§—É–Ω–∫—Ü–∏—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è, callback queries –∏ –¥—Ä—É–≥–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- **–ü–æ–ª—è:** user_id, username, chat_id, message_type, is_command, command, text_preview, callback_data

### 2. –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö

#### `handlers/start.py`
- ‚úÖ `/start` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞, –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞, –æ—à–∏–±–æ–∫
- ‚úÖ `/help` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ —Å–ø—Ä–∞–≤–∫–∏
- ‚úÖ –ú–µ–Ω—é –ø—Ä–æ–µ–∫—Ç–æ–≤ - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–µ–Ω—é
- ‚úÖ –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é

#### `handlers/expense.py`
- ‚úÖ –í—Ö–æ–¥—è—â–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è - –ø–∞—Ä—Å–∏–Ω–≥, –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ –ö–æ–º–∞–Ω–¥–∞ `/add` - –Ω–∞—á–∞–ª–æ, –≤–∞–ª–∏–¥–∞—Ü–∏—è, —É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞
- ‚úÖ –í–≤–æ–¥ —Å—É–º–º—ã - –≤–∞–ª–∏–¥–∞—Ü–∏—è, –æ—à–∏–±–∫–∏ —Ñ–æ—Ä–º–∞—Ç–∞
- ‚úÖ –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ - –≤–∞–ª–∏–¥–∞—Ü–∏—è, –Ω–µ–≤–µ—Ä–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞ - —É—Å–ø–µ—Ö/–æ—à–∏–±–∫–∞ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ –û—Ç–º–µ–Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–π - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–º–µ–Ω—ã

#### `handlers/export.py`
- ‚úÖ –ö–æ–º–∞–Ω–¥–∞ `/export` - –Ω–∞—á–∞–ª–æ, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö - –Ω–∞—á–∞–ª–æ, —É—Å–ø–µ—Ö, –æ—à–∏–±–∫–∏, –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ –≥–æ–¥–æ–≤ - —É—Å–ø–µ—Ö, –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- ‚úÖ Callback queries - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –∫–Ω–æ–ø–æ–∫

#### `handlers/stats.py`
- ‚úÖ –ö–æ–º–∞–Ω–¥–∞ `/month` - –∑–∞–ø—Ä–æ—Å, —É—Å–ø–µ—Ö, –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤ - —É—Å–ø–µ—Ö, –æ—à–∏–±–∫–∏
- ‚úÖ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π

#### `handlers/project.py`
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ - –Ω–∞—á–∞–ª–æ, —É—Å–ø–µ—Ö, –æ—à–∏–±–∫–∏, –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ –°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ - —É—Å–ø–µ—Ö, –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫
- ‚úÖ –í—ã–±–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ - —É—Å–ø–µ—Ö, –æ—à–∏–±–∫–∏
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ - —É—Å–ø–µ—Ö, –æ—à–∏–±–∫–∏

### 3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —É—Ç–∏–ª–∏—Ç–∞—Ö

#### `utils/excel.py`
- ‚úÖ `add_expense` - –Ω–∞—á–∞–ª–æ, —É—Å–ø–µ—Ö, –æ—à–∏–±–∫–∏ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ `get_month_expenses` - —É—Å–ø–µ—Ö, –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ—à–∏–±–∫–∏
- ‚úÖ `get_category_expenses` - —É—Å–ø–µ—Ö, –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ—à–∏–±–∫–∏
- ‚úÖ `get_all_expenses` - —É—Å–ø–µ—Ö, –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ—à–∏–±–∫–∏
- ‚úÖ `get_day_expenses` - —É—Å–ø–µ—Ö, –ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ, –æ—à–∏–±–∫–∏
- ‚úÖ `set_budget` - —É—Å–ø–µ—Ö, –æ—à–∏–±–∫–∏

#### `utils/db.py`
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—É–ª–∞ - –Ω–∞—á–∞–ª–æ, —É—Å–ø–µ—Ö, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—É–ª–∞ - –Ω–∞—á–∞–ª–æ, —É—Å–ø–µ—Ö
- ‚úÖ `execute` - –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ç–∞–±–ª–∏—Ü–µ–π, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª—É–∂–µ–±–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- ‚úÖ `fetch` - –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–±–æ—Ä–∫–∏, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫

#### `utils/helpers.py`
- ‚úÖ –û—à–∏–±–∫–∏ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –±—é–¥–∂–µ—Ç–∞

#### `utils/visualization.py`
- ‚úÖ –û—à–∏–±–∫–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –±—é–¥–∂–µ—Ç–∞

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫ –≤ `main.py`
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏–π —Å –ø–æ–ª–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ Telegram API

## üìã –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

### –í—Ö–æ–¥—è—â–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- `message_received` - —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- `callback_received` - callback query
- `update_received` - –¥—Ä—É–≥–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥—ã
- `command_executed` - –∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
- `command_start` - –Ω–∞—á–∞–ª–æ –∫–æ–º–∞–Ω–¥—ã
- `command_success` - —É—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- `command_error` - –æ—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –í–∞–ª–∏–¥–∞—Ü–∏—è
- `invalid_amount_format` - –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å—É–º–º—ã
- `invalid_amount` - –Ω–µ–≤–∞–ª–∏–¥–Ω–∞—è —Å—É–º–º–∞
- `invalid_category_selected` - –Ω–µ–≤–µ—Ä–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è
- `invalid_command_format` - –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∫–æ–º–∞–Ω–¥—ã
- `amount_validated` - —Å—É–º–º–∞ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–∞
- `category_validated` - –∫–∞—Ç–µ–≥–æ—Ä–∏—è –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–∞

### –û–ø–µ—Ä–∞—Ü–∏–∏
- `expense_added` - —Ä–∞—Å—Ö–æ–¥ –¥–æ–±–∞–≤–ª–µ–Ω
- `add_expense_start` - –Ω–∞—á–∞–ª–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
- `add_expense_success` - —É—Å–ø–µ—à–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ
- `add_expense_error` - –æ—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
- `project_create_success` - –ø—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω
- `export_success` - —ç–∫—Å–ø–æ—Ä—Ç —É—Å–ø–µ—à–µ–Ω
- `month_stats_sent` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞

### –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö
- `month_stats_empty` - –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∑–∞ –º–µ—Å—è—Ü
- `get_month_expenses_empty` - –ø—É—Å—Ç–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- `export_no_data` - –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
- `project_list_empty` - –Ω–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤

### –û—à–∏–±–∫–∏
- `error_occurred` - –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞
- `critical_error` - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞
- `telegram_error` - –æ—à–∏–±–∫–∞ Telegram API
- `db_fetch_error` - –æ—à–∏–±–∫–∞ –≤—ã–±–æ—Ä–∫–∏ –∏–∑ –ë–î
- `db_execute_error` - –æ—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –≤ –ª–æ–≥–∞—Ö –≤—ã —É–≤–∏–¥–∏—Ç–µ:

1. **–ö–∞–∂–¥–æ–µ –≤—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ** —Å –¥–µ—Ç–∞–ª—è–º–∏
2. **–ö–∞–∂–¥—É—é –∫–æ–º–∞–Ω–¥—É** —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
3. **–ö–∞–∂–¥—É—é –æ–ø–µ—Ä–∞—Ü–∏—é** —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (user_id, project_id, amount, etc.)
4. **–ö–∞–∂–¥—É—é –æ—à–∏–±–∫—É** —Å –ø–æ–ª–Ω—ã–º traceback –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
5. **–í–∞–ª–∏–¥–∞—Ü–∏—é** - –ø–æ—á–µ–º—É –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–µ –ø—Ä–æ—à–ª–∞
6. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –∫–æ–≥–¥–∞ –∏ –ø–æ—á–µ–º—É –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
7. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–π

## üìä –ü—Ä–∏–º–µ—Ä—ã

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥–∞
```
[timestamp] INFO [telegram.updates] message_received user_id=123 command=/add
[timestamp] INFO [handlers.expense] command_executed command=add user_id=123
[timestamp] INFO [handlers.expense] amount_input_received user_id=123 input_text=100
[timestamp] INFO [handlers.expense] amount_validated user_id=123 amount=100.0
[timestamp] INFO [handlers.expense] category_validated user_id=123 category=–ø—Ä–æ–¥—É–∫—Ç—ã amount=100.0
[timestamp] INFO [utils.excel] add_expense_start user_id=123 amount=100.0 category=–ø—Ä–æ–¥—É–∫—Ç—ã
[timestamp] INFO [utils.excel] add_expense_success user_id=123 duration=0.025
[timestamp] INFO [handlers.expense] expense_added user_id=123 amount=100.0 category=–ø—Ä–æ–¥—É–∫—Ç—ã
```

### –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
```
[timestamp] INFO [handlers.expense] invalid_amount_format user_id=123 input_text=abc reason=not_a_number
[timestamp] INFO [handlers.expense] invalid_category_selected user_id=123 category=–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è reason=category_not_in_list
```

### –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö
```
[timestamp] INFO [handlers.stats] month_stats_empty user_id=123 month=1 year=2026
[timestamp] INFO [utils.excel] get_month_expenses_empty user_id=123 month=1 year=2026
```

## üîç –ê–Ω–∞–ª–∏–∑

–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ:
- –û—Ç—Å–ª–µ–¥–∏—Ç—å –ø—É—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ª—é–±–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏
- –ù–∞–π—Ç–∏ –ø—Ä–∏—á–∏–Ω—É –æ—à–∏–±–∫–∏
- –ü–æ–Ω—è—Ç—å –ø–æ—á–µ–º—É –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
- –ò–∑–º–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ 33 —Ç–µ—Å—Ç–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ! ‚úÖ
