# Changelog: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

## –í–µ—Ä—Å–∏—è: 2026-01-16

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏ (—Å–æ–∑–¥–∞–Ω–∏–µ, –≤—ã–±–æ—Ä, —É–¥–∞–ª–µ–Ω–∏–µ) –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é –∏—Å—á–µ–∑–∞–ª–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∞—Å—å —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã `/start`.

### ‚úÖ –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### 1. `utils/helpers.py`

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –§—É–Ω–∫—Ü–∏—è `get_main_menu_keyboard()` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:**
- –§—É–Ω–∫—Ü–∏—è `cancel_conversation()` - –¥–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `restore_keyboard=True`
  - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ç–µ–ø–µ—Ä—å –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
  - –ú–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ `restore_keyboard=False`

```python
async def cancel_conversation(
    update, 
    context, 
    message="–û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞.", 
    clear_data=False, 
    restore_keyboard=True  # <- –ù–æ–≤–æ–µ
):
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –ø—Ä–∏ restore_keyboard=True
```

#### 2. `handlers/project.py`

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —Ç–µ–ø–µ—Ä—å –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É:

- ‚úÖ `project_delete_confirm()` - –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è/–æ—Ç–º–µ–Ω—ã —É–¥–∞–ª–µ–Ω–∏—è
- ‚úÖ `project_delete_cancel()` - –ø—Ä–∏ –æ—Ç–º–µ–Ω–µ —É–¥–∞–ª–µ–Ω–∏—è
- ‚úÖ `button_project_create_confirm()` - –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ `button_project_select_confirm()` - –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ `project_main_command()` - –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∞ –æ–±—â–∏–µ —Ä–∞—Å—Ö–æ–¥—ã

**–ù–µ –∏–∑–º–µ–Ω–µ–Ω–æ:** –§—É–Ω–∫—Ü–∏–∏ –Ω–∞—á–∞–ª–∞ conversation (–∑–∞–ø—Ä–æ—Å –≤–≤–æ–¥–∞) –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —É–¥–∞–ª—è—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É - —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
- `button_project_delete_start()` - –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ ID –ø—Ä–æ–µ–∫—Ç–∞
- `button_project_create_start()` - –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –Ω–∞–∑–≤–∞–Ω–∏—è
- `button_project_select_start()` - –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –≤—ã–±–æ—Ä–∞

#### 3. `handlers/expense.py`

**–û–±–Ω–æ–≤–ª–µ–Ω–æ:**
- –û—Ç–º–µ–Ω–∞ –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ–ø–µ—Ä—å –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –º–µ–Ω—é

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –§—É–Ω–∫—Ü–∏—è `cancel()` —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é `helpers.cancel_conversation()`, –ø–æ—ç—Ç–æ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏–ª–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.

### üìã –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### ‚úÖ –î–æ: –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∏—Å—á–µ–∑–∞–ª–∞
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "üìÅ –ü—Ä–æ–µ–∫—Ç—ã"
2. –ë–æ—Ç: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é –ø—Ä–æ–µ–∫—Ç–æ–≤
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "üÜï –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç"
4. –ë–æ—Ç: "–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ" (–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —É–¥–∞–ª—è–µ—Ç—Å—è)
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–û—Ç–ø—É—Å–∫"
6. –ë–æ—Ç: "‚úÖ –ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω" (–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –ù–ï –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è) ‚ùå
```

#### ‚úÖ –ü–æ—Å–ª–µ: –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "üìÅ –ü—Ä–æ–µ–∫—Ç—ã"
2. –ë–æ—Ç: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—é –ø—Ä–æ–µ–∫—Ç–æ–≤
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "üÜï –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–µ–∫—Ç"
4. –ë–æ—Ç: "–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ" (–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —É–¥–∞–ª—è–µ—Ç—Å—è)
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–û—Ç–ø—É—Å–∫"
6. –ë–æ—Ç: "‚úÖ –ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω" (–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è) ‚úÖ
```

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- ‚úÖ –í—Å–µ 33 —Ç–µ—Å—Ç–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞: 26%
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

### üì¶ –ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã

```
modified:   utils/helpers.py          (+20 lines)
modified:   handlers/project.py       (+8 imports, ~8 locations)
modified:   handlers/expense.py       (+2 lines)
new file:   FIX_KEYBOARD_DISAPPEAR.md
new file:   CHANGELOG_KEYBOARD_FIX.md
```

### üîÑ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞:
- –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã `cancel_conversation()` —Ä–∞–±–æ—Ç–∞—é—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `restore_keyboard` –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `True`
- –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ: `restore_keyboard=False`

### üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö ConversationHandler:

```python
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
from utils.helpers import get_main_menu_keyboard

async def my_handler_finish(update, context):
    await update.message.reply_text(
        "–û–ø–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!",
        reply_markup=get_main_menu_keyboard()  # <- –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–µ–Ω—é
    )
    return ConversationHandler.END

# ‚úÖ –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ cancel_conversation —Å restore_keyboard=True (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
async def my_handler_cancel(update, context):
    return await helpers.cancel_conversation(
        update, 
        context, 
        "–û–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–º–µ–Ω–µ–Ω–∞."
        # restore_keyboard=True –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    )
```

### üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –ø–æ—Å–ª–µ –ª—é–±–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –≤—ã–∑—ã–≤–∞—Ç—å `/start` - –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, —á—Ç–æ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∞–µ—Ç UX –±–æ—Ç–∞.
